---
date: "2021-11-30"
title: "设计模式学习笔记 - 概览"
tags: ["design-pattern"]
abstract: "本文为设计模式学习笔记的概览，包括阐述设计模式的作用、分类、原则与学习设计模式的意义。"
requirements: []
series: "design-pattern"
references:
  [
    ["Head First 设计模式"],
    ["design pattern 包教不包会", "https://wizardforcel.gitbooks.io/design-pattern-lessons/content/index.html"],
    ["设计模式", "https://refactoringguru.cn/design-patterns#intro-why-learn"],
    ["设计模式之七大基本原则", "https://zhuanlan.zhihu.com/p/24614363"],
  ]
---

## 前言

**设计模式** 是软件设计中常见问题的典型解决方案，可用于解决代码中反复出现的设计问题。

笔者学习设计模式的目的至少包括以下几点：

- 阅读文章时，提及的设计模式能快速反应；
- 阅读源码时，进一步把握代码设计本质；
- 提高系统设计能力；

笔者学习设计模式的资料以列在引用中。

## 分类

设计模式按 意图/目的 分为三类：

- 创建型模式：关注如何创建对象的问题，以增加已有代码的灵活度与可服用性；
- 结构型模式：关注如何组装类与对象的问题，同时保持结构的灵活和高效；
- 行为模式：关注对象间的交互的问题；

## 原则

以下是一般情况下设计模式应当遵循的原则，其中前五个原则被称为 **SOLID**。

### 单一职责原则 (Single Responsibility Principle, SRP, S)

> [Wiki - 单一功能原则](https://zh.wikipedia.org/wiki/%E5%8D%95%E4%B8%80%E5%8A%9F%E8%83%BD%E5%8E%9F%E5%88%99)

一个类只负责一项功能，以避免因某功能的无法工作、内部实现改变、依赖改变等影响到其他功能的正常运行。

如 抽象工厂模式 只负责 对象的创建。

在实际开发中，使用 SRP 容易造成需要维护更多的类，因此需要根据实际场景使用。

### 开放-关闭原则 (Open-Closed Principle, OCP, O)

软件实体（类、模块、函数等）应对扩展开放，对修改关闭。换句话说，当需要对软件实体进行扩展时，如果可以通过继承、组合等方式扩展为新的软件实体，那么遵守这一原则；如果必须要修改其内部实现，则违反这一原则。

实际上不可能让每一个模块都遵循这一原则（如 API 层），对于越基础的模块越应该遵循这一原则（如各 util 模块）。

### 里氏替换原则 (Liskov Substitution Principle, LSP, L)

用子类替换父类时行为应保持不变，即子类可以扩展父类的功能，但不能够改变父类，具体的：

- 子类可以增加自己特有的方法；
- 一般情况下，子类不能覆盖父类的非抽象方法；
- 如果需要覆盖父类的非抽象方法，方法的前置条件（即 形参）需要比父类的更宽松；
- 当实现父类的抽象方法时，方法的后置条件（即 返回值）比父类更严格；

这一原则是为了避免子类在实现新功能时导致了旧功能出现问题。

### 接口隔离原则 (Interface Segregation Principle, ISP, I)

客户端不应该依赖于它不需要的接口，一个类对另一个类的依赖应该建立在最小的接口上。这一原则的目的是使得系统解耦合，从而易于重构。

实际应用：Angular 的生命周期 hook 接口分开为 `OnInit`, `OnDestroy` 等，用到对应生命周期的组件则实现相应的接口。

### 依赖倒转原则 (Dependence Inversion Principle, DIP, D)

高层模块不应该依赖于低层模块，二者都应该依赖于抽象。这一原则使得高层模块与低层模块都易于复用与替换。

比如：假设某模块依赖于 文件系统模块 `fs`，可以令其依赖于接口 `IFileSystem`，这样使用依赖注入模式便可以将文件系统模块替换掉，如替换为 内存模拟实现的文件系统 `memFs`（这正是 `webpack-dev-server` 所做的，编译后的文件不存放于硬盘中，而存放于内存中，以加快开发效率）

### 迪米特法则 (Law Of Demeter, LOD)

又称 “最少知识原则”，指一个对象应对其他对象保持最少的了解，以降低对象间的耦合程度。

### 组合/聚合复用原则 (Composite/Aggregate Reuse Principle, CARP)

在开发中，尽量使用组合，而不是继承。这是因为在继承中，一旦基类变化，则所有子类也不得不变化，缺乏灵活性。
